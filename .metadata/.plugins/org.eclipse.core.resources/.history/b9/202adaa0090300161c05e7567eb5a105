package hanto.teststudentthhughes.common.board.pathplanner;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.LinkedList;
import java.util.List;

import org.junit.Test;

import hanto.common.HantoCoordinate;
import hanto.common.HantoException;
import hanto.studentthhughes.common.coordinate.HantoCoordinateImpl;
import hanto.studentthhughes.common.hantoboardandboardtools.pathbuilder.AStarWalking;
import hanto.studentthhughes.common.hantoboardandboardtools.pathbuilder.PathBuilder;

public class AStarWalkingTest {
	
	private static final PathBuilder astar = new AStarWalking();
	
	// Path Planning 
		@Test
		public void testPathBuildFromStraightLineLength() throws HantoException
		{	
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,-1), new HantoCoordinateImpl(0,2));
			assertTrue(path.size() == 4);
		}
		
		@Test
		public void testPathBuildFromStraightLineValues() throws HantoException
		{
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,-1), new HantoCoordinateImpl(0,2));
			TestPathContents(path, hc(0,-1),hc(0,0),hc(0,1),hc(0,2));
		}
		
		
		@Test
		public void testPathCalculationAvoidingObstacleLength() throws HantoException
		{	
			theBoard.placeOnBoard(PA, CA);
			theBoard.placeOnBoard(PB,CB);
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,-1), new HantoCoordinateImpl(0,2));
			assertTrue(path.size() == 5);
		}
		
		@Test
		public void testPathCalculationAvoidingObstacleValues() throws HantoException
		{	
			theBoard.placeOnBoard(PA, CA);
			theBoard.placeOnBoard(PB,CB);
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,-1), new HantoCoordinateImpl(0,2));
			TestPathContents(path,hc(0,-1),hc(-1,0),hc(-1,1),hc(-1,2),hc(0,2));
		}
		
		@Test
		public void testPathBetweenNeighboringPointsTestLength() throws HantoException{
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,0), new HantoCoordinateImpl(0,1));
			assertEquals(path.size(),2);
		}
		
		@Test
		public void testPathBetweenNeighboringPointsTestValues() throws HantoException{
			List<HantoCoordinate> path = astar.getPath(null, new HantoCoordinateImpl(0,0), new HantoCoordinateImpl(0,1));
			TestPathContents(path,hc(0,0),hc(0,1));
		}
		
		
		// Helper Functions
		private HantoCoordinateImpl hc(int x, int y) {
			// TODO Auto-generated method stub
			return new HantoCoordinateImpl(x,y);
		}
		
		private List<HantoCoordinateImpl> coordinatePathToImplPath(List<HantoCoordinate> path){
			List<HantoCoordinateImpl> implList = new LinkedList<HantoCoordinateImpl>();
			for(HantoCoordinate hc: path){
				implList.add(new HantoCoordinateImpl(hc));
			}
			return implList;
		}
		
		private void TestPathContents(List<HantoCoordinate> path, HantoCoordinateImpl...coordinateImpls){
			int counter = 0;
			for(HantoCoordinateImpl hci : coordinateImpls){
				assertTrue(coordinatePathToImplPath(path).contains(hci));
				counter++;
			}
			assertEquals(path.size(),counter);
		}
}
